(()=>{var e={};e.id=220,e.ids=[220],e.modules={399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},209:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9348:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},412:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},1415:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>l.a,__next_app__:()=>d,pages:()=>u,routeModule:()=>m,tree:()=>c});var r=a(9442),s=a(42),i=a(8190),l=a.n(i),n=a(3289),o={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let c=["",{children:["items",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,648)),"/home/yuichi/fantre/frontend/src/app/items/page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,1112)),"/home/yuichi/fantre/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,6042,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,3881))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],u=["/home/yuichi/fantre/frontend/src/app/items/page.tsx"],d={require:a,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/items/page",pathname:"/items",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3091:(e,t,a)=>{Promise.resolve().then(a.bind(a,2958))},983:(e,t,a)=>{Promise.resolve().then(a.bind(a,1566))},9599:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var r=a(6493),s=a(2950);let i=({addClass:e="",labelValue:t="",defaultValue:a="",inputName:i,type:l="text",pattern:n,required:o=!1,formId:c,inputId:u,placeholder:d="",maxLength:m=30})=>{let h=(0,s.Z)("block bg-my-light-green w-60 h-[40px] rounded-3xl text-center py-2 hover:opacity-80",e);return(0,r.jsxs)("div",{className:"w-60 mx-auto",children:[(0,r.jsx)("label",{htmlFor:u,className:"h-5 mt-1 overflow-auto w-full",children:t}),(0,r.jsx)("input",{className:h,placeholder:d,name:i,type:l,defaultValue:a,pattern:n||void 0,maxLength:m,required:o,form:c,id:u})]})}},5549:(e,t,a)=>{"use strict";a.d(t,{Z:()=>i});var r=a(6493),s=a(2950);let i=({children:e,addClass:t=""})=>{let a=(0,s.Z)("block bg-my-orange w-60 h-[40px] rounded-3xl mx-auto mt-4 py-2 hover:opacity-80",t);return(0,r.jsx)("button",{className:a,type:"submit",children:(0,r.jsx)("p",{children:e})})}},1566:(e,t,a)=>{"use strict";a.d(t,{default:()=>L});var r=a(6493),s=a(9599),i=a(868),l=a(4390),n=a(5549),o=a(7235),c=a(6208),u=a(5345),d=a(2831),m=a(3606);let h=async(e,t,a,r)=>{e.preventDefault();let s=new FormData(e.currentTarget);if("default"===s.get("list-id")?.toString()){alert("リストを選択してください");return}let i=`${c.II}list-items`;s.set("listItems",t.join(",")),await fetch(i,{method:"POST",body:s}).then(e=>{200===e.status?(a([]),r("default")):alert("コレクションリストに追加できませんでした")})},p=e=>{for(let[t]of e)if(c.cy.includes(t))return!0;return!1};var x=a(2061);let f=e=>{let t={items:[{id:"",item_name:""}],maxPage:1};return e&&e.items&&(t.items=e.items,e.all_pages&&(t.maxPage=e.all_pages)),t},g=async(e,t,a,r="")=>0!==t.size&&p(t)?f(await (0,x.y)(e,t,a.currentPage,r)):f(),y=({inputName:e,categoryListObject:t})=>(0,r.jsxs)("div",{className:"w-60 mx-auto",children:[(0,r.jsx)("label",{htmlFor:"category-select",className:"h-5 mt-1 overflow-auto w-full",children:"グッズカテゴリー"}),(0,r.jsxs)("select",{className:"block bg-my-light-green w-60 h-[40px] rounded-3xl text-center py-2 hover:opacity-80",name:e,id:"category-select",children:[(0,r.jsx)("option",{value:"default",children:"指定しない"}),Object.entries(t).map(e=>{let[t,a]=e;return(0,r.jsx)("option",{value:t,children:a},t)})]})]});var j=a(842),w=a(183),v=a(1406),b=a(4971);let P=({imageUrl:e})=>(0,r.jsx)("div",{className:"w-[120px] h-[120px]",children:(0,r.jsx)(m.Suspense,{children:(0,r.jsx)(b.default,{src:e,alt:"グッズの画像です！",width:120,height:120})})}),S=({itemList:e,itemsToAddToCollectionList:t,setItemsToAddToCollectionList:a,currentImageUrlList:s})=>e.map((e,i)=>""===e.id?null:(0,r.jsxs)(v.Z,{children:[(0,r.jsx)(w.Z,{href:`items/${e.id}`,addClass:"w-[calc(100%-168px)]",children:e.item_name}),(0,r.jsx)(j.Z,{itemsToAddToCollectionList:t,setItemsToAddToCollectionList:a,itemId:e.id}),(0,r.jsx)(P,{imageUrl:s[i]})]},e.id)),_=(e,t)=>{e.preventDefault();let a=new FormData(e.currentTarget),r=new URLSearchParams;for(let[e,t]of a.entries())""!==t&&("category_id"!==e||"default"!==t)&&r.append(e,t.toString());t(r)},I=({children:e,handleSetSearchInput:t})=>(0,r.jsx)("form",{className:"h-[calc(100%*9/12)] min-h-[calc(64px*9)] flex flex-col justify-around Y-tab:grid Y-tab:grid-cols-2 Y-tab:h-[calc(100%*5/6)] Y-tab:min-h-[320px]",onSubmit:e=>_(e,t),id:"itemSearch",children:e}),$=({collectionLists:e,selectList:t,setSelectList:a})=>{let s=e.map(e=>{let[t,a]=Object.entries(e)[0];return(0,r.jsx)("option",{value:t,children:a},t)});return(0,r.jsxs)("select",{className:"mx-auto mt-4 py-2 h-[40px] w-60 rounded-3xl bg-my-orange text-center hover:opacity-80",id:"list_id",name:"list-id",required:!0,value:t,onChange:e=>a(e.currentTarget.value),children:[(0,r.jsx)("option",{value:"default",children:"追加先リスト選択"}),s]})},L=({initialSearchInput:e,initialItemList:t,initialPageState:a,seriesName:p,characterName:x,collectionLists:f,initialImageUrlList:j,categoryListObject:w})=>{let v=(0,m.useRef)(!0),[b,P]=(0,m.useState)(t),[_,L]=(0,m.useState)(e),[N,Z]=(0,m.useState)(a),[k,C]=(0,m.useState)([]),[T,R]=(0,m.useState)("default"),[U,A]=(0,m.useState)(j);return(0,m.useEffect)(()=>{if(v.current){v.current=!1;return}(async()=>{let e=await g("items",_,N);if(e.maxPage&&e.maxPage!==N.maxPage){let t={currentPage:N.currentPage,maxPage:N.maxPage};t.maxPage=e.maxPage,Z(t)}P(e.items[0]?.id===""?[]:e.items)})()},[N,_]),(0,m.useEffect)(()=>{if(v.current){v.current=!1;return}(async()=>{let e=Array(10).fill(c.BJ);for(let t=0;t<b.length;t++){let a=b[t].id;if(""===a)return;let r=await fetch(`/api/getImageUrl?endpoint=images/${a}`),s=200!==r.status?c.BJ:(await r.json()).split("localhost").join("s3-minio");e[t]=s}A(e)})()},[b]),(0,r.jsx)(l.Z,{headerContent:(0,r.jsx)(o.Z,{}),viewContent:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.Z,{children:(0,r.jsx)(S,{itemList:b,itemsToAddToCollectionList:k,setItemsToAddToCollectionList:C,currentImageUrlList:U})}),(0,r.jsx)(d.Z,{pageState:N,handleSetPageState:Z})]}),naviContent:(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"h-full",children:[(0,r.jsxs)(I,{handleSetSearchInput:L,children:[(0,r.jsx)(s.Z,{addClass:"Y-tab:col-start-2",defaultValue:p||"",type:"search",inputName:c.cy[0],labelValue:"作品名",placeholder:c.QT.isPartialMatch}),(0,r.jsx)(s.Z,{defaultValue:x||"",type:"search",inputName:c.cy[1],labelValue:"キャラ名",placeholder:c.QT.isPartialMatch}),(0,r.jsx)(s.Z,{type:"search",inputName:c.cy[2],labelValue:"商品名",placeholder:c.QT.isPartialMatch}),(0,r.jsx)(s.Z,{type:"search",inputName:c.cy[3],labelValue:"タグ",placeholder:c.QT.isListFormat}),(0,r.jsx)(y,{inputName:c.cy[4],categoryListObject:w}),(0,r.jsx)(s.Z,{type:"number",inputName:c.cy[5],pattern:"[a-zA-Z0-9]*",labelValue:"JANコード",maxLength:13}),(0,r.jsx)(s.Z,{type:"date",inputName:c.cy[6],labelValue:"発売日(以前検索)"}),(0,r.jsx)(s.Z,{type:"search",inputName:c.cy[7],labelValue:"購入場所",placeholder:c.QT.isListFormat}),(0,r.jsx)(n.Z,{children:"検索する！"})]}),(0,r.jsxs)("div",{className:"min-h-[calc(56px*3)] flex flex-col h-[calc(100%*3/12)] Y-tab:flex-row Y-tab:min-h-[56px] Y-tab:h-[calc(100%/6)]",children:[(0,r.jsx)(i.Z,{href:"/lists",addClass:"mt-4 w-60",children:"コレクションリスト作成"}),(0,r.jsxs)("form",{onSubmit:e=>h(e,k,C,R),className:"Y-tab:mx-auto Y-tab:translate-y-[-50%] Y-tab:h-[200%] Y-tab:grid Y-tab:grid-rows-2",children:[(0,r.jsx)($,{collectionLists:f,selectList:T,setSelectList:R}),(0,r.jsx)(n.Z,{children:"選択項目をリストに追加"})]})]})]})}),footerContent:!0})}},2061:(e,t,a)=>{"use strict";a.d(t,{B:()=>i,y:()=>s});var r=a(6208);let s=async(e,t,a,s="")=>{let i=`${r.II}${e}`,l=new URLSearchParams(t);l.set("currentPage",a.toString());let n=`${i}?${l}`,o=""===s?await fetch(n):await fetch(n,{headers:{cookie:s}});return 200!==o.status?null:o.json()},i=async(e,t)=>{let a=t?`&seriesId=${t}`:"",s=`${r.II}items/create?endpoint=${e}${a}`,i=await fetch(s);return 200!==i.status?null:i.json()}},648:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var r=a(7705),s=a(7176),i=a(2958);let l=async e=>{let t=await fetch(`${s.II}items/create?endpoint=category`,{headers:{cookie:e}});return 200===t.status?await t.json():[]},n=e=>{for(let[t]of e)if(s.cy.includes(t))return!0;return!1};var o=a(5093);let c=e=>{let t={items:[{id:"",item_name:""}],maxPage:1};return e&&e.items&&(t.items=e.items,e.all_pages&&(t.maxPage=e.all_pages)),t},u=async(e,t,a,r="")=>0!==t.size&&n(t)?c(await (0,o.y)(e,t,a.currentPage,r)):c();var d=a(8551),m=a(8051);let h=async({searchParams:e})=>{let t=(await (0,m.Qk)()).get("fantre");if(!t)return;let a=`fantre=${t.value}`,{seriesName:n,characterName:c}=await e,h=n?new URLSearchParams([["series_name",n],["character_name",c]]):new URLSearchParams,p={currentPage:1,maxPage:1},x=await u("items",h,p,a),f=x.items;p.maxPage=x.maxPage;let g=await l(t.value),y=await (0,o.y)("lists",new URLSearchParams,1,a),j=Array(10).fill(s.BJ);for(let e=0;e<f.length&&""!==f[e].id;e++){let t=`images/${f[e].id}`,a=await (0,d.Jn)(t)||s.BJ,r=a===s.BJ?s.BJ:a.split("localhost").join("s3-minio");j[e]=r}return(0,r.jsx)(i.default,{initialSearchInput:h,initialItemList:f,initialPageState:p,seriesName:n,characterName:c,collectionLists:y,initialImageUrlList:j,categoryListObject:g})}},2958:(e,t,a)=>{"use strict";a.d(t,{default:()=>r});let r=(0,a(8105).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/home/yuichi/fantre/frontend/src/features/routes/items/components/ItemsPage.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/home/yuichi/fantre/frontend/src/features/routes/items/components/ItemsPage.tsx","default")},8551:(e,t,a)=>{"use strict";a.d(t,{$z:()=>l,Jn:()=>n,M1:()=>o,fs:()=>i});var r=a(8051);let s="http://localhost:3000/api/",i=async(e,t)=>{let a=(await (0,r.Qk)()).get("fantre");if(!a)return Response.error();let i=new Headers({cookie:a.value}),l=`${s}${e}?${t}`,n=await fetch(l,{headers:i});return 200!==n.status?null:n.json()},l=async e=>{let t=(await (0,r.Qk)()).get("fantre");if(!t)return Response.error();let a=`${s}${e}`,i=new URLSearchParams([["currentPage","1"]]),l=`${a}?${i}`,n=await fetch(l,{headers:{cookie:t.value}});return 200!==n.status?null:n.json()},n=async e=>{let t=(await (0,r.Qk)()).get("fantre");if(console.log("cookie-getImageUrl",t),!t)return Response.error();let a=`${s}/getImageUrl?endpoint=${e}`;console.log("requestUrl-getImageUrl",a);let i=await fetch(a,{headers:{cookie:t.value}});return i?.status===200?await i.json():null},o=async()=>{let e=(await (0,r.Qk)()).get("fantre");if(!e)return Response.error();let t=`${s}lists`,a=await fetch(t,{headers:{cookie:e.value}});return 200!==a.status?null:a.json()}}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[492,146,81,51,289],()=>a(1415));module.exports=r})();